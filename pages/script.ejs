<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io();

    function createMessage(id, name, title, msg, time) {
        var div = document.createElement("div");
        div.className = "msg";

        var titleElement = document.createElement("p");
        var titleLink = document.createElement("a");
        titleLink.href = "/p/" + id;
        var titleText = document.createTextNode(title);
        titleLink.appendChild(titleText);
        titleElement.appendChild(titleLink);
        div.appendChild(titleElement);

        var msgElement = document.createElement("blockquote");
        var msgText = document.createTextNode(msg);
        msgElement.appendChild(msgText);
        div.appendChild(msgElement);

        var timeElement = document.createElement("p");
        var timeText = document.createTextNode(name + " | " + time);
        timeElement.appendChild(timeText);
        div.appendChild(timeElement);
        return div;
    }

    socket.on("message", function (id, name, msg, time) {
        var msgs = document.getElementById("messages");
        var newMessage = createMessage(id, name, msg, time);
        msgs.insertBefore(newMessage, msgs.firstChild);
        console.log(msg);
    });
</script>